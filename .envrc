#!/usr/bin/env bash

set -euo pipefail

export PROJECT_ROOT="${PROJECT_ROOT:-$(git rev-parse --show-toplevel 2>/dev/null || pwd)}"

# ------------------------------------------------------------
# Verify GCP Access
# ------------------------------------------------------------

# Check if gcloud is installed
if ! command -v gcloud &> /dev/null; then
    echo "⚠️  Warning: gcloud CLI is not installed" >&2
    echo "   Install from: https://cloud.google.com/sdk/docs/install" >&2
else
    # Check if authenticated
    if ! gcloud auth application-default print-access-token &> /dev/null; then
        echo "⚠️  Warning: GCP application-default credentials not found" >&2
        echo "   Run: gcloud auth application-default login" >&2
        exit 1
    fi
fi

# ------------------------------------------------------------
# Pass Credentials
# ------------------------------------------------------------

# export VAULT_ADDR="${VAULT_ADDR:-$(pass vault/dev/address)}"
# export VAULT_TOKEN="${VAULT_TOKEN:-$(pass vault/dev/token)}"
